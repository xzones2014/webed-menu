!function(t){"use strict";var e=function(){var t=$("body"),e=$(".nestable-menu"),a=$("#menu_structure"),l=$("#deleted_nodes"),i=[],n=function(){var l={listGroup:$("#menus_template_list_group").html(),listItem:$("#menus_template_list_item").html()},n=Helpers.jsonDecode(a.val(),[]),r=function(){e.nestable({group:1,maxDepth:10,expandBtnHTML:"",collapseBtnHTML:""})},d=function(){t.on("click",".dd-item .dd3-content a.show-item-details",function(t){t.preventDefault(),$(this).toggleClass("active"),$(this).closest(".dd-item").toggleClass("active")}),t.on("change keyup",".dd-item .item-details .fields input[type=text], .dd-item .item-details .fields select",function(t){t.preventDefault();var e=$(this),a=e.closest("label"),l=e.closest(".dd-item");l.data(a.attr("data-field"),e.val())})},s=function(t){var e=$(l.listGroup);return _.each(t,function(t,a){e.append(c(t))}),e},c=function(t){var e=l.listItem,a=Helpers.arrayGet(t,"type",""),i=Helpers.arrayGet(t,"title");_.size(i)||(i=Helpers.arrayGet(t,"model_title","")),e=e.replace(/__title__/gi,i),e=e.replace(/__type__/gi,a);var n=$(e);return n.find("[data-field=title] input[type=text]").val(Helpers.arrayGet(t,"title","")),n.find("[data-field=icon_font] input[type=text]").val(Helpers.arrayGet(t,"icon_font","")),n.find("[data-field=css_class] input[type=text]").val(Helpers.arrayGet(t,"css_class","")),n.find("[data-field=target] select").val(Helpers.arrayGet(t,"target","")),"custom-link"!==a?(n.find("[data-field=url]").remove(),n.data("url",null)):(n.find("[data-field=url] input[type=text]").val(Helpers.arrayGet(t,"url","")),n.data("url",Helpers.arrayGet(t,"url",null))),n.data("id",Helpers.arrayGet(t,"id","")),n.data("related_id",Helpers.arrayGet(t,"related_id","")),n.data("type",Helpers.arrayGet(t,"type","")),n.data("title",Helpers.arrayGet(t,"title","")),n.data("model_title",Helpers.arrayGet(t,"model_title","")),n.data("icon_font",Helpers.arrayGet(t,"icon_font","")),n.data("css_class",Helpers.arrayGet(t,"css_class","")),n.data("target",Helpers.arrayGet(t,"target","")),Helpers.arrayGet(t,"children",[])&&n.append(s(Helpers.arrayGet(t,"children"))),n},p=function(){e.append(s(n))},u=function(){_.size(e.find("> .dd-list"))||e.append($(l.listGroup)),t.on("click",".box-link-menus .add-item",function(t){t.preventDefault();var l=$(this).closest(".box-link-menus");switch(l.data("type")){case"custom-link":e.find("> .dd-list").append(a(l));break;default:e.find("> .dd-list").append(i(l))}});var a=function(t){var e={id:null,related_id:null,type:t.data("type"),title:t.find("input[type=text][data-field=title]").val(),model_title:null,url:t.find("input[type=text][data-field=url]").val(),css_class:t.find("input[type=text][data-field=css_class]").val(),icon_font:t.find("input[type=text][data-field=icon_font]").val(),target:t.find("select[data-field=target]").val()};if(e.title&&e.url)return t.find("input[type=text]").val(""),c(e)},i=function(t){var e={id:null,type:t.data("type")},a=[];return t.find("input[type=checkbox]:checked").each(function(){var t=$(this),l=t.closest("label"),i=$.extend(!0,{related_id:t.val(),title:null,model_title:l.text().trim(),url:"",css_class:"",icon_font:""},e);a.push(c(i))}),t.find("input[type=checkbox]").prop("checked",!1),a}},o=function(){t.on("click",".dd-item .item-details .btn-remove",function(t){t.preventDefault();var e=$(this).closest(".dd-item"),a=e.find("> .dd-list > .dd-item");_.size(a)&&e.after(a),i.push(e.data("id")),e.remove()})};p(),r(),d(),u(),o()},r=function(){var n=function(){return e.nestable("serialize")};t.on("submit",e.closest("form"),function(t){a.val(Helpers.jsonEncode(n())),l.val(Helpers.jsonEncode(i))})};return{init:function(){n(),r()}}}();!function(t){t(window).load(function(){e.init()})}(jQuery)}(this.LaravelElixirBundle=this.LaravelElixirBundle||{});
//# sourceMappingURL=edit-menu.js.map
